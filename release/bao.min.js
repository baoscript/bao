!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.Bao=e(require("jQuery")):t.Bao=e(t.jQuery)}("undefined"!=typeof self?self:this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(e,n){e.exports=t},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=(n(0),n(6)),c=function(){function t(e){r(this,t),this.baoStepFactory_=e,this.vars_=new Map,this.steps_=new Map}return a(t,[{key:"getBaoStepFactory",value:function(){return this.baoStepFactory_}},{key:"getStep",value:function(t){return this.steps_.get(t)}},{key:"setStep",value:function(t,e){this.steps_.set(t,e)}},{key:"maybeDeclareVar",value:function(t,e){this.hasVar(t)||this.vars_.set(t,u.createVariable(t,e))}},{key:"getVar",value:function(t){return this.vars_.get(t)}},{key:"setVar",value:function(t,e){"object"===(void 0===e?"undefined":i(e))&&e.expr?this.setVar(t,this.eval(e.expr)):(this.maybeDeclareVar(t,void 0===e?"undefined":i(e)),this.vars_.get(t).setVal(e))}},{key:"hasVar",value:function(t){return this.vars_.has(t)}},{key:"getVarContext_",value:function(){var t={},e=!0,n=!1,r=void 0;try{for(var i,a=this.vars_[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var u=o(i.value,2),c=u[0],f=u[1];t[c]=f.getVal()}}catch(t){n=!0,r=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}return t}},{key:"eval",value:function(t){return new Function("with(this){return "+t+"}").call(this.getVarContext_())}},{key:"sync",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.vars_[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var a=o(r.value,2);a[0];a[1].sync()}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}}]),t}();t.exports=c},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),u=(n(1),function(){function t(e){r(this,t),this.type_="BaoStep",this.context_=e,this.name_=void 0,this.print_=void 0,this.init_=void 0,this.set_=new Map,this.baoStepFactory_=e.getBaoStepFactory()}return i(t,[{key:"getType",value:function(){return this.type_}},{key:"getName",value:function(){return this.name_}},{key:"parseJsonData",value:function(t){if(t){if(this.name_=t.name,t.init&&(this.init_=this.baoStepFactory_(this.context_,t.init)),void 0!==t.print&&(this.print_=t.print),t.decl)for(var e in t.decl)this.context_.maybeDeclareVar(e,t.decl[e]);if(t.set)for(var n in t.set)this.set_.set(n,t.set[n])}}},{key:"setVars_",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.set_[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var a=o(r.value,2),u=a[0],c=a[1];this.context_.setVar(u,c)}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},{key:"run",value:function(){return a("[data-bao-action]").off("click").prop("disabled",!0),console.log("Current step: "+this.name_+" ("+this.getType()+")"),this.init_&&this.init_.run(),this.set_&&this.setVars_(),void 0!=this.print_&&console.log(this.print_),null}}]),t}());t.exports=u},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),u=function(){function t(e,n){r(this,t),this.name_=e,this.val_=void 0,this.type_=n,this.updateDomElements_()}return i(t,[{key:"setVal",value:function(t){if((void 0===t?"undefined":o(t))!==this.type_)throw"Invalid "+this.type_+" "+t;this.val_=t,this.updateDomElements_()}},{key:"getVal",value:function(){return this.val_}},{key:"updateDomElements_",value:function(){a('[data-bao-target="'+this.name_+'"]').val(this.val_)}},{key:"sync",value:function(){var t=a('[data-bao-target="'+this.name_+'"]').val();this.val_=this.parseString(t)}},{key:"parseString",value:function(t){throw"This method is not implemented"}}]),t}();t.exports=u},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=(n(0),n(5)),a=n(1),u=function(){function t(){r(this,t),this.context_=new a(i.createBaoStep)}return o(t,[{key:"parseString",value:function(t){var e=JSON.parse(t),n=!0,r=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var c=a.value;this.context_.setStep(c.name,i.createBaoStep(this.context_,c))}}catch(t){r=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw o}}return this}},{key:"run",value:function(){this.context_.getStep("#begin").run()}}]),t}();t.exports={runBao:function(t){(new u).parseString(t).run()}}},function(t,e,n){function r(t,e){if(e.if){var n=new i(t);return n.parseJsonData(e),n}if(e.goto){var r=new u(t);return r.parseJsonData(e),r}if(e.next){var f=new c(t);return f.parseJsonData(e),f}if(e.switch){var s=new a(t);return s.parseJsonData(e),s}var l=new o(t);return l.parseJsonData(e),l}var o=(n(0),n(1),n(2)),i=n(10),a=n(11),u=n(12),c=n(13);t.exports={createBaoStep:r}},function(t,e,n){function r(t,e){switch(e){case"number":return new o(t);case"string":return new i(t);case"boolean":return new BoolVariable(t);default:throw"Unsupported type "+e}}var o=(n(0),n(3),n(7)),i=n(8);n(9);t.exports={createVariable:r}},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(3),c=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"number"))}return i(e,t),a(e,[{key:"parseString",value:function(t){if("NaN"===t)return NaN;if(val=Number(t),isNaN(val))throw"Invalid number "+t;return val}}]),e}(u);t.exports=c},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(3),c=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"string"))}return i(e,t),a(e,[{key:"parseString",value:function(t){return t}}]),e}(u);t.exports=c},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(3),c=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"boolean"))}return i(e,t),a(e,[{key:"parseString",value:function(t){switch(t){case"1":case"true":return!0;case"0":case"false":return!1;default:throw"A boolean value must be either true or false ("+t+")"}}}]),e}(u);t.exports=c},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=(n(0),n(1),n(2)),f=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type_="IfStep",n.condition_=void 0,n.thenStep_=void 0,n.elseStep_=void 0,n}return i(e,t),a(e,[{key:"parseJsonData",value:function(t){if(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.if||!t.if.condition||!t.if.then)throw"Invalid if step";this.condition_=t.if.condition,this.thenStep_=this.baoStepFactory_(this.context_,t.if.then),t.if.else&&(this.elseStep_=this.baoStepFactory_(this.context_,t.if.else))}},{key:"run",value:function(){if(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this),!this.condition_||!this.thenStep_)throw"Invalid if step";return this.context_.eval(this.condition_)?this.thenStep_.run():this.elseStep_?this.elseStep_.run():null}}]),e}(c);t.exports=f},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=(n(0),n(1),n(2)),s=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type_="SwitchStep",n.expr_=void 0,n.cases_=new Map,n.defaultStep_=void 0,n}return i(e,t),u(e,[{key:"parseJsonData",value:function(t){if(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.switch||!t.switch.expr||!t.switch.cases)throw"Invalid switch step";this.expr_=t.switch.expr;var n=!0,r=!1,o=void 0;try{for(var i,u=t.switch.cases[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var f=a(i.value,2),s=f[0],l=f[1];this.cases_.set(s,this.baoStepFactory_(this.context_,l))}}catch(t){r=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw o}}t.switch.default&&(this.defaultStep_=this.baoStepFactory_(this.context_,t.switch.default))}},{key:"run",value:function(){if(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this),!this.expr_||!this.cases_)throw"Invalid switch step";var t=this.context_.eval(this.expr_),n=this.cases_.get(t);return n?n.run():this.defaultStep_?this.defaultStep_.run():null}}]),e}(f);t.exports=s},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},c=(n(0),n(1),n(2)),f=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type_="GotoStep",n.goto_=void 0,n}return i(e,t),a(e,[{key:"parseJsonData",value:function(t){if(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.goto)throw"Invalid goto step";this.goto_=t.goto}},{key:"run",value:function(){if(u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this),!this.goto_||!this.context_.getStep(this.goto_))throw"Invalid goto step";return this.context_.getStep(this.goto_).run()}}]),e}(c);t.exports=f},function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},f=n(0),s=(n(1),n(2)),l=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type_="ActionStep",n.nextSteps_=new Map,n}return i(e,t),u(e,[{key:"parseJsonData",value:function(t){if(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.next)throw"Invalid action step";if(t.next)for(var n in t.next){var r=this.baoStepFactory_(this.context_,t.next[n]);this.nextSteps_.set(n,r)}}},{key:"run",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this);var t=!0,n=!1,r=void 0;try{for(var o,i=this.nextSteps_[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=a(o.value,2),f=u[0],s=u[1];this.registerButton_(f,s)}}catch(t){n=!0,r=t}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return null}},{key:"registerButton_",value:function(t,e){f('[data-bao-action="'+t+'"]').prop("disabled",!1).click([this.context_,e],function(t){t.data[0].sync(),t.data[1].run()})}}]),e}(s);t.exports=l}])});
//# sourceMappingURL=bao.min.js.map