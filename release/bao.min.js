!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.Bao=e(require("jQuery")):t.Bao=e(t.jQuery)}("undefined"!=typeof self?self:this,function(__WEBPACK_EXTERNAL_MODULE_0__){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_0__},function(module,exports,__webpack_require__){function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function t(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),$=__webpack_require__(0),evalWithContext=function(t,e){return new Function("with(this){return "+e+"}").call(t.getVarContext())},Variable=function(){function Variable(t){_classCallCheck(this,Variable),this.name_=t,this.val_=null,this.updateDomElements_()}return _createClass(Variable,[{key:"setVal",value:function(t,e){"object"===(void 0===t?"undefined":_typeof(t))&&t.expr?this.val_=evalWithContext(e,t.expr):this.val_=t,this.updateDomElements_()}},{key:"getVal",value:function(){return this.val_}},{key:"updateDomElements_",value:function(){$('[data-bao-target="'+this.name_+'"]').val(this.val_)}},{key:"sync",value:function sync(){var el=$('[data-bao-target="'+this.name_+'"]');try{this.val_=eval(el.val())}catch(t){this.val_=el.val()}}}]),Variable}(),Context=function(){function t(){_classCallCheck(this,t),this.vars_=new Map,this.steps_=new Map}return _createClass(t,[{key:"getStep",value:function(t){return this.steps_.get(t)}},{key:"setStep",value:function(t,e){this.steps_.set(t,e)}},{key:"maybeDeclareVar",value:function(t){this.hasVar(t)||this.vars_.set(t,new Variable(t))}},{key:"getVar",value:function(t){return this.vars_.get(t)}},{key:"setVar",value:function(t,e){this.maybeDeclareVar(t),this.vars_.get(t).setVal(e,this)}},{key:"hasVar",value:function(t){return this.vars_.has(t)}},{key:"getVarContext",value:function(){var t={},e=!0,r=!1,n=void 0;try{for(var o,i=this.vars_[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=_slicedToArray(o.value,2),s=a[0],u=a[1];t[s]=u.getVal()}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}return t}},{key:"sync",value:function(){var t=!0,e=!1,r=void 0;try{for(var n,o=this.vars_[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=_slicedToArray(n.value,2);i[0];i[1].sync()}}catch(t){e=!0,r=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw r}}}}]),t}();module.exports={Context:Context,evalWithContext:evalWithContext}},function(t,e,r){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=(r(0),r(3)),a=r(1).Context,s=function(){function t(){n(this,t),this.context_=new a}return o(t,[{key:"parseString",value:function(t){var e=JSON.parse(t),r=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this.context_.setStep(u.name,i.createBaoStep(this.context_,u))}}catch(t){n=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}}},{key:"run",value:function(){this.context_.getStep("#begin").run()}}]),t}();t.exports=s},function(t,e,r){function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)},s=function(){function t(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=r(0),c=r(1),f=(c.Context,function(){function t(e){i(this,t),this.type_="BaoStep",this.context_=e,this.name_=void 0,this.print_=void 0,this.init_=void 0,this.set_=new Map}return u(t,[{key:"getType",value:function(){return this.type_}},{key:"getName",value:function(){return this.name_}},{key:"parseJsonData",value:function(e){if(e){if(this.name_=e.name,e.init&&(this.init_=t.create(this.context_,e.init)),void 0!==e.print&&(this.print_=e.print),e.decl){var r=!0,n=!1,o=void 0;try{for(var i,a=e.decl[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;this.context_.maybeDeclareVar(s)}}catch(t){n=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}}if(e.set)for(var u in e.set)this.set_.set(u,e.set[u])}}},{key:"setVars_",value:function(){var t=!0,e=!1,r=void 0;try{for(var n,o=this.set_[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=s(n.value,2),a=i[0],u=i[1];this.context_.setVar(a,u)}}catch(t){e=!0,r=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw r}}}},{key:"run",value:function(){return l("[data-bao-action]").off("click").prop("disabled",!0),console.log("Current step: "+this.name_+" ("+this.getType()+")"),this.init_&&this.init_.run(),this.set_&&this.setVars_(),void 0!=this.print_&&console.log(this.print_),null}}],[{key:"create",value:function(e,r){if(r.if){var n=new p(e);return n.parseJsonData(r),n}if(r.goto){var o=new _(e);return o.parseJsonData(r),o}if(r.next){var i=new y(e);return i.parseJsonData(r),i}if(r.switch){var a=new h(e);return a.parseJsonData(r),a}var s=new t(e);return s.parseJsonData(r),s}}]),t}()),p=function(t){function e(t,r){i(this,e);var o=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return o.type_="IfStep",o.condition_=void 0,o.thenStep_=void 0,o.elseStep_=void 0,o}return o(e,t),u(e,[{key:"parseJsonData",value:function(t){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.if||!t.if.condition||!t.if.then)throw"Invalid if step";this.condition_=t.if.condition,this.thenStep_=f.create(this.context_,t.if.then),t.if.else&&(this.elseStep_=f.create(this.context_,t.if.else))}},{key:"run",value:function(){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this),!this.condition_||!this.thenStep_)throw"Invalid if step";return c.evalWithContext(this.context_,this.condition_)?this.thenStep_.run():this.elseStep_?this.elseStep_.run():null}}]),e}(f),h=function(t){function e(t,r){i(this,e);var o=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return o.type_="SwitchStep",o.expr_=void 0,o.cases_=new Map,o.defaultStep_=void 0,o}return o(e,t),u(e,[{key:"parseJsonData",value:function(t){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.switch||!t.switch.expr||!t.switch.cases)throw"Invalid switch step";this.expr_=t.switch.expr;var r=!0,n=!1,o=void 0;try{for(var i,u=t.switch.cases[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var l=s(i.value,2),c=l[0],p=l[1];this.cases_.set(c,f.create(this.context_,p))}}catch(t){n=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(n)throw o}}t.switch.default&&(this.defaultStep_=f.create(this.context_,t.switch.default))}},{key:"run",value:function(){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this),!this.expr_||!this.cases_)throw"Invalid switch step";var t=c.evalWithContext(this.context_,this.expr_),r=this.cases_.get(t);return r?r.run():this.defaultStep_?this.defaultStep_.run():null}}]),e}(f),_=function(t){function e(t,r){i(this,e);var o=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return o.type_="GotoStep",o.goto_=void 0,o}return o(e,t),u(e,[{key:"parseJsonData",value:function(t){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.goto)throw"Invalid goto step";this.goto_=t.goto}},{key:"run",value:function(){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this),!this.goto_||!this.context_.getStep(this.goto_))throw"Invalid goto step";return this.context_.getStep(this.goto_).run()}}]),e}(f),y=function(t){function e(t,r){i(this,e);var o=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return o.type_="ActionStep",o.nextSteps_=new Map,o}return o(e,t),u(e,[{key:"parseJsonData",value:function(t){if(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseJsonData",this).call(this,t),!t.next)throw"Invalid action step";if(t.next)for(var r in t.next){var n=f.create(this.context_,t.next[r]);this.nextSteps_.set(r,n)}}},{key:"run",value:function(){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"run",this).call(this);var t=!0,r=!1,n=void 0;try{for(var o,i=this.nextSteps_[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=s(o.value,2),l=u[0],c=u[1];this.registerButton_(l,c)}}catch(t){r=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}return null}},{key:"registerButton_",value:function(t,e){l('[data-bao-action="'+t+'"]').prop("disabled",!1),l('[data-bao-action="'+t+'"]').click([this.context_,e],function(t){t.data[0].sync(),t.data[1].run()})}}]),e}(f);t.exports={createBaoStep:f.create}}])});
//# sourceMappingURL=bao.min.js.map